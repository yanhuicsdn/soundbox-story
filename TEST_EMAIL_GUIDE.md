# 📧 声宝盒邮件发送测试步骤

## 🚀 快速测试(5分钟)

### 步骤1: 启动邮件服务

打开终端,运行:

```bash
cd ~/soundbox-story
npm install
npm run dev
```

看到以下信息表示成功:
```
╔════════════════════════════════════════╗
║   声宝盒邮件服务已启动                  ║
╚════════════════════════════════════════╝

📧 服务地址: http://localhost:3000
🏥 健康检查: http://localhost:3000/health
```

### 步骤2: 打开测试页面

在浏览器中打开:
```
http://localhost:3000/test-email.html
```

或者直接在文件管理器中双击打开:
```
/Users/yanhui/soundbox-story/test-email.html
```

### 步骤3: 填写测试表单

**必填项:**
- 宝宝名字: 例如"测试宝宝"
- 选择声音: 选择"爸爸"或"妈妈"
- 邮箱地址: 输入你的测试邮箱

**可选项:**
- 孩子年龄: 选择年龄
- 录音文件: 可以录制或上传音频文件

### 步骤4: 选择测试方式

**方式1: 录音测试**
1. 点击"🎙️ 开始录音"
2. 朗读一段话(建议录制文本: "小兔子乖乖,把门儿开开")
3. 点击"⏹️ 停止录音"
4. 点击"试听"确认录音
5. 点击"📤 发送测试邮件"

**方式2: 上传音频文件**
1. 点击"上传音频文件"
2. 选择任意音频文件(.mp3/.wav等)
3. 点击"📤 发送测试邮件"

### 步骤5: 检查结果

**成功的话,页面显示:**
```
✅ 邮件发送成功!
消息ID: <message-id>
文件名: 测试宝宝_爸爸_xxx@xxx.com.wav

请检查邮箱 1543827@qq.com 查收邮件
```

**同时,你的邮箱 1543827@qq.com 会收到:**
- 邮件主题: "新订单: 测试宝宝(爸爸的声音)"
- 邮件内容: 包含完整的订单信息
- 邮件附件: 录音文件

---

## 🔍 故障排查

### 问题1: 页面显示"发送失败"

**检查项:**
1. 邮件服务是否启动?
   ```bash
   # 在另一个终端窗口运行
   curl http://localhost:3000/health
   ```
   应该返回: `{"status":"ok","message":"声宝盒邮件服务运行正常"}`

2. SMTP配置是否正确?
   - 检查 `.env` 文件是否存在
   - 确认SMTP_USER和SMTP_PASS正确

3. 查看服务器日志
   ```bash
   # 在邮件服务终端查看错误信息
   ```

### 问题2: 录音功能不工作

**解决方案:**
- 使用Chrome浏览器
- 允许麦克风权限
- 或直接上传音频文件测试

### 问题3: 没收到邮件

**检查项:**
1. 检查垃圾邮件文件夹
2. 确认邮箱地址是 1543827@qq.com
3. 查看SMTP服务是否正常(搜狐邮箱有时不稳定)

---

## 📊 测试成功示例

**表单填写:**
```
宝宝名字: 测试小明
声音类型: 爸爸的声音
邮箱: test@example.com
年龄: 5岁
```

**收到的邮件:**
```
主题: 新订单: 测试小明(爸爸的声音)

内容:
声宝盒 - 新订单信息

====================
宝宝信息
====================
姓名: 测试小明
声音: 爸爸的声音
年龄: 5

====================
家长信息
====================
邮箱: test@example.com
微信: 测试微信

====================
订单信息
====================
故事包: 测试故事包
价格: ¥0

====================
录音文件
====================
文件名: 测试小明_爸爸_test@example.com.wav
文件大小: XX KB
上传时间: 2024-01-12 XX:XX:XX
```

**附件:**
- `测试小明_爸爸_test@example.com.wav`

---

## 🎯 测试清单

- [ ] 邮件服务启动成功
- [ ] 测试页面可以打开
- [ ] 表单填写完整
- [ ] 录音功能正常(或上传文件)
- [ ] 点击发送后显示"发送成功"
- [ ] 邮箱 1543827@qq.com 收到邮件
- [ ] 邮件内容完整(宝宝信息+音频附件)
- [ ] 音频文件可以播放

---

## ✅ 全部通过?

如果以上都成功,说明邮件功能正常!可以:

1. **集成到主网站** - 用户下单后会自动发送邮件
2. **开始正式运营** - 接收真实订单
3. **批量生成音频** - 使用你的AI技术生成故事

---

## 📝 下一步

邮件测试成功后,可以:

1. 准备示例音频文件
2. 准备故事内容(120个故事)
3. 开始推广网站
4. 接收真实订单并批量生成

---

**开始测试吧!** 🚀

有任何问题随时告诉我!
